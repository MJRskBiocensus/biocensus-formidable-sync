(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,r=window.wp.i18n,a=window.wp.blocks,l=window.wp.shortcode,n=window.wp.data,o=window.wp.blockEditor,s=window.wp.apiFetch;var c=e.n(s);const i=window.wp.components,m=window.wp.element;function h({color:e,onChange:a}){return(0,t.createElement)(i.Dropdown,{renderToggle:({onToggle:a})=>(0,t.createElement)(i.Button,{onClick:a,variant:"secondary",size:"small",className:"frm-color-picker-button frm-charts-same-input-height"},(0,t.createElement)(i.ColorIndicator,{className:"block-editor-panel-color-gradient-settings__color-indicator",colorValue:e}),(0,t.createElement)("span",{className:"frm-charts-color-button-text"},e||(0,r.__)("color","frm-charts"))),renderContent:()=>(0,t.createElement)(i.ColorPicker,{color:e,onChange:a})})}const d=window.wp.primitives,u=(0,t.createElement)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(d.Path,{d:"M14.7 11.3c1-.6 1.5-1.6 1.5-3 0-2.3-1.3-3.4-4-3.4H7v14h5.8c1.4 0 2.5-.3 3.3-1 .8-.7 1.2-1.7 1.2-2.9.1-1.9-.8-3.1-2.6-3.7zm-5.1-4h2.3c.6 0 1.1.1 1.4.4.3.3.5.7.5 1.2s-.2 1-.5 1.2c-.3.3-.8.4-1.4.4H9.6V7.3zm4.6 9c-.4.3-1 .4-1.7.4H9.6v-3.9h2.9c.7 0 1.3.2 1.7.5.4.3.6.8.6 1.5s-.2 1.2-.6 1.5z"})),f=(0,t.createElement)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(d.Path,{d:"M12.5 5L10 19h1.9l2.5-14z"})),p=(e,t)=>{for(let r=0;r<t.length;r++)if(e===t[r].value)return t[r].label;return null},_=(e,t)=>e.filter(((e,r)=>t!==r)),g=()=>{const e=x();return Object.keys(e.dataTypeOptions).map((t=>({value:t,label:e.dataTypeOptions[t]})))},v=()=>[{name:"group_by",label:(0,r.__)("Group by","frm-charts"),type:"select",options:[{value:"",label:(0,r.__)("None","frm-charts")},{value:"month",label:(0,r.__)("Month","frm-charts")},{value:"quarter",label:(0,r.__)("Quarter","frm-charts")},{value:"year",label:(0,r.__)("Year","frm-charts")}],desc:(0,r.__)("Group entries by month, quarter, or year.","frm-charts")},{name:"is_stacked",label:(0,r.__)("Is stacked","frm-charts"),type:"toggle",desc:(0,r.__)("Place related values atop one another. If there are any negative values, they are stacked in reverse order below the chart's axis baseline.","frm-charts")},{name:"x_title_size",label:(0,r.__)("Title size","frm-charts"),type:"size",desc:(0,r.__)("Set the font size of the x-axis title. This parameter will only apply if x_title is included.","frm-charts")},{name:"x_title_color",label:(0,r.__)("Title color","frm-charts"),type:"color",default:"",desc:(0,r.__)("Set the font color of the x-axis title. This parameter will only apply if x_title is included.","frm-charts")},{name:"x_labels_size",label:(0,r.__)("Labels size","frm-charts"),type:"size",desc:(0,r.__)("Set the font size of the labels on the x-axis.","frm-charts")},{name:"x_slanted_text",label:(0,r.__)("Slanted text","frm-charts"),type:"toggle",default:!0,desc:(0,r.__)("By default the labels on the x-axis are slanted. To remove the slant and make the labels horizontal, use x_slanted_text=0.","frm-charts")},{name:"x_text_angle",label:(0,r.__)("Text angle","frm-charts"),desc:(0,r.__)("Set the angle of the slanted text labels on the x axis.","frm-charts")},{name:"x_show_text_every",label:(0,r.__)("Show text every","frm-charts"),desc:(0,r.__)('Determine how often an x-axis label should be displayed. If you would like to show the x-axis label for every bar or coordinate, use x_show_text_every="1". If you would like to show the x-axis label for every three bars or coordinates, use x_show_text_every="3".',"frm-charts")},{name:"x_order",label:(0,r.__)("Order","frm-charts"),type:"select",options:[{value:"",label:(0,r.__)("Default","frm-charts")},{value:"field_opts",label:(0,r.__)("Field options","frm-charts")},{value:"desc",label:(0,r.__)("Description","frm-charts")}],desc:(0,r.__)('Determine the order for your x-axis labels. By default, a field\'s options will be graphed alphabetically. You may reverse this order with x_order="desc". If you\'re graphing a checkbox, dropdown, or radio button field and you would like to remove alphabetical ordering, add x_order="field_opts" to your graph shortcode. When you remove alphabetical ordering, the options will be graphed in the same order as your field options.',"frm-charts")}],b=()=>[{name:"y_title_size",label:(0,r.__)("Title size","frm-charts"),type:"size",desc:(0,r.__)("Set the font size of the y-axis title. This parameter will only apply if y_title is included.","frm-charts")},{name:"y_title_color",label:(0,r.__)("Title color","frm-charts"),type:"color",desc:(0,r.__)("Set the font color of the y-axis title. This parameter will only apply if y_title is included.","frm-charts")},{name:"y_labels_size",label:(0,r.__)("Labels size","frm-charts"),type:"size",desc:(0,r.__)("Set the font size of the labels on the y-axis.","frm-charts")}],E=()=>[{name:"bg_color",label:(0,r.__)("Background color","frm-charts"),type:"color",desc:(0,r.__)("Change the background color.","frm-charts")},{name:"grid_color",label:(0,r.__)("Grid color","frm-charts"),type:"color",desc:(0,r.__)("Change the color of the horizontal lines on the graph.","frm-charts")},{name:"x_grid_color",label:(0,r.__)("X grid color","frm-charts"),type:"color",desc:(0,r.__)("Change the color of the vertical lines on the graph.","frm-charts")},{name:"chart_area_width",label:(0,r.__)("Chart width","frm-charts"),type:"size",units:["px","%"],desc:(0,r.__)("Set the width of the chart area to pixels or a percent.","frm-charts")},{name:"chart_area_height",label:(0,r.__)("Chart height","frm-charts"),type:"size",units:["px","%"],desc:(0,r.__)("Set the height of the chart area to pixels or a percent.","frm-charts")},{name:"chart_area_top",label:(0,r.__)("Chart top","frm-charts"),type:"size",units:["px","%"],desc:(0,r.__)("Set the top placement of the chart area to pixels or a percent.","frm-charts")},{name:"chart_area_left",label:(0,r.__)("Chart left","frm-charts"),type:"size",units:["px","%"],desc:(0,r.__)("Set the left placement of the chart area to pixels or a percent.","frm-charts")},{name:"is3d",label:(0,r.__)("3D graph","frm-charts"),type:"toggle",chartTypes:["pie"],desc:(0,r.__)("Turn your graph three-dimensional. This option is only available for pie graphs.","frm-charts")},{name:"pie_hole",label:(0,r.__)("Pie hole","frm-charts"),type:"number",min:0,max:.9,step:.1,chartTypes:["pie"],desc:(0,r.__)("Turn your pie graph into a donut graph. This option accepts values between 0 and .9, corresponding to the ratio of the donut hole to the chart.","frm-charts")},{name:"curve_type",label:(0,r.__)("Curve line","frm-charts"),chartTypes:["line"],type:"toggle",desc:(0,r.__)("Smooth the lines of a line graph.","frm-charts")},{name:"no_data",label:(0,r.__)("No data","frm-charts"),desc:(0,r.__)("Determine the message that will display when there is no data to be shown on the graph.","frm-charts")},{name:"pagesize",label:(0,r.__)("Page size","frm-charts"),chartTypes:["table"],type:"number",min:1,step:1,desc:(0,r.__)("The number of rows in each page, when using the table graph type.","frm-charts")},{name:"sort_column",label:(0,r.__)("Sort column","frm-charts"),type:"toggle",desc:(0,r.__)("Change the column to sort by on page load when using the table graph type. 0 is the first column and 1 is column 2.","frm-charts")},{name:"sort_ascending",label:(0,r.__)("Sort ascending","frm-charts"),type:"toggle",desc:(0,r.__)("Change the sorting order on page load when using the table graph type.","frm-charts")}],y=()=>[{name:"legend_size",label:(0,r.__)("Legend size","frm-charts"),type:"size",desc:(0,r.__)("Change the size of the legend in pixels. This parameter will only apply if show_key is included.","frm-charts")},{name:"tooltip_label",label:(0,r.__)("Tooltip label","frm-charts"),desc:(0,r.__)("Change the default tooltip label for a graph. The tooltip label defaults to the field title.","frm-charts")}],x=()=>window.FrmChartsGraph||{},w=()=>x().defaultSettings||{},C=()=>{const e=w();return e.colors?e.colors.split(","):[]},k=()=>[{label:(0,r.__)("Select a filter","frm-charts"),value:""},{label:(0,r.__)("User ID","frm-charts"),value:"user_id",desc:(0,r.__)("Graph entries for a specific user or for the current logged-in user. Insert the ID of a specific user or use 'current' to only graph data from the current user.","frm-charts")},{label:(0,r.__)("Entry","frm-charts"),value:"entry",desc:(0,r.__)("Display a graph of a specific entry or entries. You may use entry IDs or keys.","frm-charts")},{label:(0,r.__)("Entry status","frm-charts"),value:"drafts",desc:(0,r.__)('By default, the frm-graph shortcode does not include draft entries. You can choose to include only drafts using drafts="1", or both drafts and entries using drafts="both".',"frm-charts")},{label:"created_at_greater_than",value:"created_at_greater_than",desc:(0,r.__)('Only include entries created after a specific or dynamic date. For example, you may show entries created in the last month with created_at_greater_than="-1 month" or use a specific date like created_at_greater_than="2016-07-31". When using a specific date, it must be in the Y-m-d format.',"frm-charts")},{label:"created_at_less_than",value:"created_at_less_than",desc:(0,r.__)('Only include entries created before a specific or dynamic date. For example, you may show entries created before today with created_at_less_than="-1 day" or use a specific date like created_at_less_than="2016-05-31". When using a specific date, it must be in the Y-m-d format.',"frm-charts")},{label:(0,r.__)("Limit","frm-charts"),value:"limit",desc:(0,r.__)("Limit the number of bars, coordinates, or pie slices displayed in the graph. This will limit the graph to the highest values.","frm-charts")},{label:(0,r.__)("Field is equal to","frm-charts"),value:"{field}",desc:(0,r.__)("Only include entries where another field in the form has a specific value.","frm-charts")},{label:(0,r.__)("Field is NOT equal to","frm-charts"),value:"{field}_not_equal",desc:(0,r.__)("Only include entries where another field in the form is NOT equal to a specific value.","frm-charts")},{label:(0,r.__)("Field is greater than","frm-charts"),value:"{field}_greater_than",desc:(0,r.__)("Only include entries where another field in the form is greater than a specific value.","frm-charts")},{label:(0,r.__)("Field is greater than or equal to","frm-charts"),value:"{field}_greater_than_or_equal_to",desc:(0,r.__)("Only include entries where another field in the form is greater than or equal to a specific value.","frm-charts")},{label:(0,r.__)("Field is less than","frm-charts"),value:"{field}_less_than",desc:(0,r.__)("Only include entries where another field in the form is less than a specific value.","frm-charts")},{label:(0,r.__)("Field is less than or equal to","frm-charts"),value:"{field}_less_than_or_equal_to",desc:(0,r.__)("Only include entries where another field in the form is less than or equal to a specific value.","frm-charts")},{label:(0,r.__)("Field contains","frm-charts"),value:"{field}_contains",desc:(0,r.__)("Only include entries where another field in the form contains a specific value.","frm-charts")}],S=(e,t)=>{for(let r=0;r<e.length;r++)if(parseInt(e[r].id)===parseInt(t))return e[r];return!1},T=e=>"function"==typeof o.useSettings?(0,o.useSettings)(e)[0]:(0,o.useSetting)(e);function F({value:e,onChange:a}){const l=e=>{const t=[];return e.map((e=>{"object"==typeof e.theme&&e.theme.map?t.push(...l(e.theme)):t.push({value:e.fontFamily.replaceAll('"',""),label:e.name||e.fontFamily})})),t},n=T("typography.fontFamilies")||[],o=[{value:"",label:(0,r.__)("Default")},...l(n)];return(0,t.createElement)(i.SelectControl,{value:e,onChange:a,options:o})}function P({units:e=["px"],...r}){return r.units=e.map((e=>({value:e,label:e,default:0}))),1===r.units.length&&(r.isUnitSelectTabbable=!1),(0,t.createElement)(i.__experimentalUnitControl,{...r})}function z({attributes:e,setAttributes:a}){const[l,n]=(0,m.useState)(!1),o=w();return(0,t.createElement)(i.Panel,null,(0,t.createElement)(i.PanelBody,{title:(0,r.__)("Title","frm-charts")},(0,t.createElement)(i.TextControl,{value:e.title||"",onChange:e=>a({title:e})}),!!e.title&&(0,t.createElement)(t.Fragment,null,l?(0,t.createElement)(i.BaseControl,{label:(0,r.__)("Title font","frm-charts")},"image"!==e.format&&(0,t.createElement)(F,{value:e.title_font||"",onChange:e=>a({title_font:e})}),(0,t.createElement)(i.__experimentalGrid,{columns:3,templateColumns:"5fr 3fr 3fr",columnGap:"10px"},(0,t.createElement)("div",null,(0,t.createElement)(h,{color:e.title_color||"",onChange:e=>a({title_color:e})})),(0,t.createElement)("div",null,(0,t.createElement)(P,{value:e.title_size||"",onChange:e=>a({title_size:e}),placeholder:(0,r.__)("size","frm-charts")})),(0,t.createElement)("div",{className:"frm-charts-font-buttons"},(0,t.createElement)(i.Button,{icon:u,onClick:()=>a({title_bold:!e.title_bold}),isPressed:e.title_bold||!1,size:"small",className:"frm-charts-same-input-height"}),o.hasOwnProperty("title_italic")&&(0,t.createElement)(i.Button,{icon:f,onClick:()=>a({title_italic:!e.title_italic}),isPressed:e.title_italic||!1,size:"small",className:"frm-charts-same-input-height"})))):(0,t.createElement)("a",{href:"#",onClick:e=>{e.preventDefault(),n(!0)}},(0,r.__)("EDIT TEXT STYLE","frm-charts")))))}const B=(0,t.createElement)(d.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(d.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),A=(0,t.createElement)(d.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(d.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),L=(0,t.createElement)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(d.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"}));function I(e){const r={...e,icon:A,iconPosition:"right",iconSize:18,text:e.text||e.children,className:(e.className||"")+" frm-charts-button-as-select"};return(0,t.createElement)(i.Button,{...r})}function N(e){const{options:a,value:l,onChange:n,placeholder:o,disabled:s}=e,[c,h]=(0,m.useState)(""),[d,u]=(0,m.useState)([]),f=c?d:a,_=e=>{h(e),u(e?a.filter((t=>t.label.toLowerCase().includes(e))):[...a])};return(0,t.createElement)(i.Dropdown,{style:{display:"block"},renderToggle:({onToggle:e})=>(0,t.createElement)(I,{onClick:e,disabled:s,text:(0,t.createElement)("span",{className:"frm-charts-button-text"},l?p(l,a):o)}),renderContent:({onToggle:e})=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(i.SearchControl,{value:c,onChange:_,size:"compact",style:{minWidth:"232px"}}),(0,t.createElement)(i.MenuGroup,null,f.map((r=>{const a=r.value===l;return(0,t.createElement)(i.MenuItem,{key:r.value,isSelected:a,onClick:()=>{var t;t=r.value,n(t),e()},role:"menuitemradio",icon:a?L:null},(0,t.createElement)(i.__experimentalTruncate,{ellipsizeMode:"tail",limit:34},r.label))})),!f.length&&(0,r.__)("No results","frm-charts")))})}function O(e){const{onChange:a,value:l}=e,[n,o]=(0,m.useState)(null),[s,i]=(0,m.useState)([]),[h,d]=(0,m.useState)(!1);return(0,m.useEffect)((()=>{if(void 0!==window.frmChartsForms)return i(window.frmChartsForms),void d(!0);c()({path:"frm-charts/v1/forms"}).then((e=>{i(e),d(!0),window.frmChartsForms=e}),(e=>{o(e),d(!0)}))}),[]),n?(0,t.createElement)("p",null,n.message):(0,t.createElement)(N,{disabled:!h,options:s.map((e=>({value:e.id,label:e.name?e.name:(0,r.__)("(no title)","frm-charts")}))),onChange:a,value:l,placeholder:(0,r.__)("Select a form","frm-charts")})}function M(e){const{options:a,value:l,onChange:n,placeholder:o,disabled:s}=e,[c,h]=(0,m.useState)(""),[d,u]=(0,m.useState)([]),f=c?d:a,p=e=>{h(e),u(e?a.filter((t=>t.label.toLowerCase().includes(e))):[...a])};return(0,t.createElement)(i.Dropdown,{style:{display:"block"},renderToggle:({onToggle:e})=>(0,t.createElement)(I,{onClick:e,disabled:s,text:l&&l.length?(0,r.sprintf)((0,r.__)("%d selected","frm-charts"),l.length):o}),renderContent:()=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(i.SearchControl,{value:c,onChange:p,size:"compact",style:{minWidth:"232px"}}),f.map((e=>{const r=l.includes(e.value);return(0,t.createElement)(i.CheckboxControl,{key:e.value,label:e.label,checked:r,onChange:t=>((e,t)=>{n(e?[...l,t]:l.filter((e=>e!==t)))})(t,e.value)})})),!f.length&&(0,r.__)("No results","frm-charts"))})}function D({onChange:e,onLoadedFields:a,fieldType:l=null,value:n,form:o}){const[s,i]=(0,m.useState)(null),[h,d]=(0,m.useState)([]),[u,f]=(0,m.useState)(!1),p=e=>{l&&(e=e.filter((e=>l===e.type))),d(e),a(e)};return(0,m.useEffect)((()=>{if(d([]),o){if(window.frmChartsFormFields=window.frmChartsFormFields||{},void 0!==window.frmChartsFormFields["form"+o])return p(window.frmChartsFormFields["form"+o]),void f(!0);c()({path:"frm-charts/v1/form-fields/"+o}).then((e=>{p(e),f(!0),window.frmChartsFormFields["form"+o]=e}),(e=>{i(e),f(!0)}))}}),[o]),s?(0,t.createElement)("p",null,s.message):(0,t.createElement)(M,{disabled:!u,options:h.map((e=>({value:e.id,label:e.name}))),value:n,onChange:e,placeholder:(0,r.__)("Select fields","frm-charts")})}const G=(0,t.createElement)(d.SVG,{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(d.Path,{d:"M8 7h2V5H8v2zm0 6h2v-2H8v2zm0 6h2v-2H8v2zm6-14v2h2V5h-2zm0 8h2v-2h-2v2zm0 6h2v-2h-2v2z"}));function V({items:e,idPrefix:r,onChange:a}){let l,n;const o=e=>{e.target.classList.add("frm-charts-faded-item"),l=e.target.closest("ul"),n=f(e.target)},s=e=>{if(e.target.classList.contains("frm-charts-faded-item")||e.target.classList.contains("frm-charts-sort-placeholder"))return;if("LI"!==e.target.tagName||!l.contains(e.target))return;const t=e.target.getBoundingClientRect(),r=t.y+t.height/2;d(),u(e.target,e.y<r?"top":"bottom")},c=e=>{e.target.classList.remove("frm-charts-faded-item");const t=h();if(t){let e=f(t);e>n&&e--;const r=m(n,e);r&&a(r),d()}l=null},m=(t,r)=>{if(t===r)return!1;const a=[];return e.forEach(((l,n)=>{n!==t&&(t>r&&n===r&&a.push({...e[t]}),a.push({...l}),t<r&&n===r&&a.push({...e[t]}))})),a},h=()=>l.querySelector(".frm-charts-sort-placeholder"),d=()=>{const e=h();e&&e.remove()},u=(e,t)=>{const r=document.createElement("li");r.classList.add("frm-charts-sort-placeholder"),"top"===t?e.before(r):e.after(r)},f=e=>Array.from(l.children).indexOf(e);return(0,t.createElement)("ul",{className:"frm-charts-sort-list"},e.map(((e,a)=>(0,t.createElement)(i.Draggable,{key:e.value,elementId:r+e.value,transferData:{testIndex:a},onDragEnd:c,onDragOver:s,onDragStart:o},(({onDraggableStart:a,onDraggableEnd:l})=>(0,t.createElement)("li",{id:r+e.value,draggable:!0,onDragStart:a,onDragEnd:l},e.label,(0,t.createElement)(i.Icon,{icon:G,size:16})))))))}function j({attributes:e,setAttributes:a}){const[l,n]=(0,m.useState)(!1);return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(i.BaseControl,null,(0,t.createElement)(O,{value:e.form,onChange:e=>{a({form:e,fields:[]})}})),(0,t.createElement)(i.BaseControl,null,(0,t.createElement)(D,{form:e.form,value:e.fields||[],onChange:e=>a({fields:e}),onLoadedFields:e=>{a({formFields:e})}}),e.fields&&e.formFields&&e.fields.length>1&&(0,t.createElement)("div",{style:{marginTop:"4px"}},(0,t.createElement)(i.Button,{variant:"link",text:(0,r.__)("Sort fields","frm-charts"),icon:l?B:A,iconSize:16,iconPosition:"right",onClick:()=>n(!l)}),l&&(0,t.createElement)(V,{items:(e.fields,o=e.formFields,e.fields.map((e=>({value:e,label:S(o,e).name})))),idPrefix:"frm-charts-sort-field-",onChange:e=>(e=>{const t=e.map((e=>e.value));a({fields:t})})(e)}))));var o}const W=(0,m.forwardRef)((function({icon:e,size:t=24,...r},a){return(0,m.cloneElement)(e,{width:t,height:t,...r,ref:a})})),H=(0,t.createElement)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(d.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})),q=(0,t.createElement)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(d.Path,{d:"M20 5h-5.7c0-1.3-1-2.3-2.3-2.3S9.7 3.7 9.7 5H4v2h1.5v.3l1.7 11.1c.1 1 1 1.7 2 1.7h5.7c1 0 1.8-.7 2-1.7l1.7-11.1V7H20V5zm-3.2 2l-1.7 11.1c0 .1-.1.2-.3.2H9.1c-.1 0-.3-.1-.3-.2L7.2 7h9.6z"}));function Z({filter:e,fieldOptions:a,onChange:l,onDelete:n}){const o=k(),s=[{value:"",label:(0,r.__)("Select a field","frm-charts")},...a],c=(t,r)=>{l({...e,[t]:r})};return(0,t.createElement)(i.Flex,{className:"frm-charts-filter-row"},(0,t.createElement)(i.FlexItem,null,(0,t.createElement)(i.SelectControl,{options:o,value:e.name,onChange:e=>c("name",e)})),e.name.indexOf("{field}")>-1&&(0,t.createElement)(i.FlexItem,null,(0,t.createElement)(i.SelectControl,{options:s,value:e.field||"",onChange:e=>c("field",e)})),(0,t.createElement)(i.FlexItem,{style:{flex:"auto"}},(0,t.createElement)(i.TextControl,{placeholder:(0,r.__)("Enter filtering value","frm-charts"),value:e.value,onChange:e=>c("value",e)})),(0,t.createElement)(i.FlexItem,null,(0,t.createElement)((({filterName:e})=>{const r=(e=>{for(let t=0;t<o.length;t++)if(e===o[t].value)return o[t].desc||"";return""})(e);return r?(0,t.createElement)(i.Tooltip,{text:r},(0,t.createElement)(W,{icon:H})):""}),{filterName:e.name}),(0,t.createElement)(i.Button,{type:"small",icon:q,onClick:n,className:"frm-charts-filter-delete-button"})))}function Y({attributes:e,setAttributes:a}){const l={name:"",value:"",field:""},[n,o]=(0,m.useState)(e.filters||[l]),[s,c]=(0,m.useState)(!1),h=()=>c(!1);return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(i.Button,{variant:"link",onClick:()=>c(!0)},(0,r.__)("+ Add filters","frm-charts")),s&&(0,t.createElement)(i.Modal,{title:(0,r.__)("Add filters","frm-charts"),onRequestClose:h,size:"large",overlayClassName:"frm-charts-filters-modal"},n.map(((r,a)=>{return(0,t.createElement)(Z,{key:a,filter:r,onChange:e=>((e,t)=>{o(n.map(((r,a)=>t===a?e:{...r})))})(e,a),onDelete:()=>(e=>{o(_(n,e))})(a),fieldOptions:(l=e.formFields||[],l.map((e=>({value:e.id,label:e.name}))))});var l})),(0,t.createElement)("p",null,(0,t.createElement)(i.Button,{variant:"secondary",size:"small",onClick:()=>{o([...n,l])}},(0,r.__)("+ Add filter","frm-charts"))),(0,t.createElement)("div",null,(0,t.createElement)(i.Button,{variant:"secondary",onClick:h,style:{marginRight:"8px"}},(0,r.__)("Cancel","frm-charts")),(0,t.createElement)(i.Button,{variant:"primary",onClick:()=>{a({filters:n}),h()}},(0,r.__)("Save","frm-charts")))))}function R({attributes:e,setAttributes:a}){return(0,t.createElement)(i.Panel,null,(0,t.createElement)(i.PanelBody,{title:(0,r.__)("Primary data source","frm-charts")},(0,t.createElement)(j,{attributes:e,setAttributes:a}),!!e.form&&(0,t.createElement)(Y,{attributes:e,setAttributes:a})))}class U extends m.Component{render(){const{property:e,value:a,onChange:l}=this.props,n=t=>{l(e.name,t)};return"toggle"===e.type?(0,t.createElement)(i.ToggleControl,{label:e.label,checked:a,onChange:()=>l(e.name,!a)}):"color"===e.type?(0,t.createElement)(i.BaseControl,{label:e.label},(0,t.createElement)("div",null,(0,t.createElement)(h,{color:a,onChange:n}),(0,t.createElement)(i.Button,{variant:"link",onClick:()=>n(""),style:{verticalAlign:"super",marginLeft:"10px"}},(0,r.__)("Clear","frm-charts")))):"number"===e.type?(0,t.createElement)(i.__experimentalNumberControl,{min:e.min||Number.NEGATIVE_INFINITY,max:e.max||Number.POSITIVE_INFINITY,step:e.step||1,label:e.label,value:a,onChange:n}):"size"===e.type?(0,t.createElement)(P,{label:e.label,value:a,onChange:n,units:e.units||["px"]}):"select"===e.type?(0,t.createElement)(i.SelectControl,{label:e.label,options:e.options||[],value:a,onChange:n}):(0,t.createElement)(i.TextControl,{label:e.label,value:a,onChange:n})}}class $ extends m.Component{render(){const{property:e,isSelected:r,onToggle:a}=this.props;return(0,t.createElement)(i.Button,{onClick:()=>a(e.name),className:"frm-charts-toggle-property-button"},(0,t.createElement)(i.Flex,{gap:5},(0,t.createElement)(i.FlexItem,{className:"frm-charts-toggle-property-label",style:{whiteSpace:"nowrap"}},e.label),(0,t.createElement)(i.FlexItem,null,(0,t.createElement)(i.Flex,{gap:0,justify:"flex-end"},(0,t.createElement)(i.FlexItem,{className:"frm-charts-toggle-property-name"},e.name),(0,t.createElement)(i.FlexItem,{className:"frm-charts-toggle-property-tooltip"},(0,t.createElement)(i.Tooltip,{text:e.desc},(0,t.createElement)(i.Icon,{icon:H,size:20}))),(0,t.createElement)(i.FlexItem,null,(0,t.createElement)(i.Icon,{icon:L,size:20,style:{visibility:r?"visible":"hidden"}}))))))}}class X extends m.Component{render(){const{properties:e,addedProperties:a,onChange:l,attributes:n}=this.props,o=e=>{h(e)?s(e):c(e)},s=e=>{l(a.filter((t=>t.name!==e)))},c=e=>{const t=m(e);l([...a,{name:e,value:t.default||""}])},m=t=>{for(let r=0;r<e.length;r++)if(t===e[r].name)return e[r];return!1},h=e=>{for(let t=0;t<a.length;t++)if(e===a[t].name)return!0;return!1},d=(e,t)=>{l(a.map((r=>r.name===e?{name:e,value:t}:{...r})))},u=e=>!("function"==typeof e.showIf&&!e.showIf(n)||Array.isArray(e.chartTypes)&&-1===e.chartTypes.indexOf(n.type));return(0,t.createElement)(t.Fragment,null,a.map((e=>{const r=m(e.name);return r&&u(r)?(0,t.createElement)("div",{key:e.name,"data-type":r.type||"text",className:"frm-charts-property-control"},(0,t.createElement)(U,{property:r,value:e.value,onChange:d}),(0,t.createElement)(i.Tooltip,{text:r.desc},(0,t.createElement)(i.Icon,{icon:H,size:20,className:"frm-charts-property-tooltip"}))):""})),(0,t.createElement)(i.Dropdown,{className:"my-container-class-name",contentClassName:"my-dropdown-content-classname",popoverProps:{placement:"bottom-start"},renderToggle:({isOpen:e,onToggle:a})=>(0,t.createElement)(i.Button,{variant:"link",onClick:a,"aria-expanded":e},(0,r.__)("+ Add more properties","frm-charts")),renderContent:()=>(0,t.createElement)(t.Fragment,null,e.map((e=>u(e)&&(0,t.createElement)($,{key:e.name,property:e,onToggle:o,isSelected:h(e.name)}))))}))}}function J({attributes:e,setAttributes:a}){const l=w(),n=void 0!==e.show_key?e.show_key:l.show_key;let o=y();return"image"===e.format&&(o=o.filter((e=>"tooltip_label"!==e.name)),o.push({name:"legend_columns",label:(0,r.__)("Number of columns","frm-charts"),type:"number",desc:(0,r.__)("Change the number of columns in the legend. This parameter will only apply if graph type is set to image.","frm-charts"),min:1,max:10,step:1,default:1})),(0,t.createElement)(i.Panel,null,(0,t.createElement)(i.PanelBody,{title:(0,r.__)("Legend","frm-charts")},(0,t.createElement)(i.ToggleControl,{label:(0,r.__)("Display a legend","frm-charts"),checked:n||!1,onChange:()=>a({show_key:!e.show_key})}),n&&(0,t.createElement)(t.Fragment,null,"geo"!==e.type&&(0,t.createElement)(i.SelectControl,{label:(0,r.__)("Legend position","frm-charts"),options:[{value:"right",label:(0,r.__)("Right","frm-charts")},{value:"left",label:(0,r.__)("Left","frm-charts")},{value:"top",label:(0,r.__)("Top","frm-charts")},{value:"bottom",label:(0,r.__)("Bottom","frm-charts")}],value:e.legend_position||l.legend_position,onChange:e=>a({legend_position:e})}),(0,t.createElement)(X,{properties:o,addedProperties:e.legendProps||[],onChange:e=>a({legendProps:e}),attributes:e}))))}function Q({options:e,value:r,onChange:a}){return(0,t.createElement)(i.Dropdown,{style:{display:"block"},popoverProps:{focusOnMount:!1},renderToggle:({onToggle:a})=>(0,t.createElement)(I,{onClick:a,text:r?p(r,e):"--"}),renderContent:({onToggle:l})=>(0,t.createElement)(i.__experimentalGrid,{columns:3,gap:"0",templateColumns:"33.33% 33.33% 33.33%",templateRows:"minmax(0, 1fr) minmax(0, 1fr) minmax(0, 1fr)"},e.map((e=>{const n=r===e.value;return(0,t.createElement)(i.Button,{key:e.value,isPressed:n,onClick:()=>{a(e.value),l()},className:"frm-charts-icon-choice"},(0,t.createElement)(W,{icon:e.icon}),(0,t.createElement)("div",null,e.label))})))})}function K({attributes:e,setAttributes:a}){const l=w();return(0,t.createElement)(i.Panel,null,(0,t.createElement)(i.PanelBody,{title:(0,r.__)("Chart settings","frm-charts")},(0,t.createElement)(i.BaseControl,{label:(0,r.__)("Type","frm-charts")},(0,t.createElement)(Q,{options:[{value:"column",label:(0,r.__)("Column","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M2.3 2.6v19.5l.1.1h19.5m-3-16.4v12.8m-4.3-5v5m-4.4-6.8v6.8m-4.4-1.9v2"}))},{value:"hbar",label:(0,r.__)("Horizontal bar","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M2.3 2.6v19.5l.1.1h19.5M18.8 5.6h-13m10 8.7h-10m7-4.3h-7m4 8.6h-4"}))},{value:"pie",label:(0,r.__)("Pie chart","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("path",{stroke:"currentColor",strokeWidth:"1.5",d:"M2.3 12.5a9 9 0 0 1 8.2-9v18a9 9 0 0 1-8.3-9ZM13.5 14h8.2a9 9 0 0 1-8.2 8.2V14Zm0-11.2a9 9 0 0 1 8.2 8.2h-8.2V2.8Z"}))},{value:"line",label:(0,r.__)("Line","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M2.3 2.6v19.5l.1.1h19.5"}),(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"m21.4 10.6-5.3 5.3c-.3.3-.8.3-1 0l-3-3a.8.8 0 0 0-1.1 0l-5.3 5.3M21.4 5.6l-5.3 5.3c-.3.3-.8.3-1 0l-3-3a.8.8 0 0 0-1.1 0l-5.3 5.3"}))},{value:"area",label:(0,r.__)("Area","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M4 17.4c0-2 2.7-4.8 5.9-4.4 2.2.3 1.8 2.7 4 3 3.2.5 5.9-4.3 5.9-4.3M9.9 6.5C6.7 6.1 4.1 9 4.1 11v8.7l.1.1h15.4l.2-.1V5.8c0-.1-.2-.2-.3 0-.8 1.1-3 4.1-5.5 3.8-2.3-.3-1.9-2.8-4.1-3Z"}),(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M4.2 19.7h15.4l.2-.1v-7.3c0-.2-.2-.3-.3-.1-.8 1.2-3 4.2-5.5 3.8-2.3-.3-1.9-2.7-4.1-3-3.2-.4-5.8 2.4-5.8 4.4v2.2l.1.1Z"}))},{value:"scatter",label:(0,r.__)("Scatter","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M2.3 2.6v19.5l.1.1h19.5"}),(0,t.createElement)("circle",{cx:"6.2",cy:"7.7",r:"1.1",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"20.3",cy:"4.6",r:".8",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"16.2",cy:"9.4",r:"1.2",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"6.5",cy:"15.9",r:".9",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"13.8",cy:"5.1",r:"1.2",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"18.2",cy:"14.8",r:"1.8",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"13.2",cy:"17.6",r:"1.2",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"10.8",cy:"11.8",r:"1.2",fill:"currentColor"}))},{value:"stepped_area",label:(0,r.__)("Stepped","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M2.3 2.6v19.5l.1.1h19.5"}),(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M5 16.5h4.8c.4 0 .7-.3.7-.8V8.3c0-.5.3-.8.8-.8h4c.4 0 .7.3.7.8v3.4c0 .5.3.8.8.8h4.7"}))},{value:"geo",label:(0,r.__)("Map","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("path",{fill:"currentColor",fillRule:"evenodd",d:"M18.1 6.6c-.4 0-.6.2-.8.4l-.3.2h-.3v.3c.1.3 0 .3-.1.2 0-.1-.1-.1-.2 0l-.2.1c-.1 0-.2 0-.3.2l-.4.2-.5.2-.7.2H14s-.3-.1-.6-.5a2 2 0 0 0-.4-.3l-1.5 1.5c-.1.2 0 .3.2.5l.2.2c0 .4.3.4.4.1l.2-.2c.2 0 .2.2 0 .5 0 .1 0 .2-.2.2l-.3-.1-.5.2-.5.3c-.2 0-.2 0 0 .3v.3l-.3.1c0 .3 0 .6.2.6s.5-.2.6-.4l.2-.2s.3 0 .5.2l.1.2v.1h.2l.1-.2.1.1h.5l.3.1c.2 0 .3.2.2.4h-.9l-.4-.1c-.2-.2-.2-.2-.5-.2a3 3 0 0 0-1 .1l-.7 1c0 .2 0 .6.2.9.2.3.3.4.9.4.5 0 .7 0 .6.2l.1.4.5 2c0 .2 0 .3.4.2.3 0 .5-.3.6-.5.1-.4.2-.5.4-.7.2 0 .2 0 .2-.4 0-.5 0-.6.3-1l.4-.7-.2-.1-.4-.1c-.1-.1-.5-.7-.4-.8h.1l.2.4.3.3h.4l.4-.4c0-.1-.1-.3-.3-.3l-.2-.2h.3l.3.2.7.3.3.6.3.4.2-.3c.1-.3.5-.7.6-.7l.3.2.2.5v.2h.1l.2-.2.1.2.2-.1c.3-.2.3-.2.2-.4-.1-.3 0-.4.3-.5.5-.1.6-.3.5-.8-.1-.2-.1-.3 0-.4.2-.2.3-.2.2 0 0 .3 0 .3.2.2.2 0 .2 0 .2-.2 0-.3 0-.3.3-.6.5-.5.6-.9.4-1v-.3c.1-.2.4-.3.6-.3.2 0 .3.1.3.6v.4l.2-.2.3-.4.2-.3c0-.2 0-.2.5-.4l.5-.3v-.2c0-.2 0-.2.3-.1h.2c.3-.3.3-.4-.2-.7-.5-.4-.8-.5-1-.5-.2 0-.5 0-.9-.2l-.9-.2-1.1-.3-.5-.3c-.3-.3-.5-.4-.7-.4h-.4Zm-10.7.6v.5l.2.3v.4l.2 1c.2.3.5.6.6.5l.2-.4V9l.5-.3.6-.5.2-.2v-.3L10 7l.2-.2H7.4v.3ZM.4 8c-.2.2-.3.2-.2.3l-.1.3v.6c0 .4 0 .5.4.6h.7c.1-.1.4-.2.5-.1l.2.3.4.4c.4.3.5.5.5 1s.2.7.6 1.4l.4.6v-.2l.1-.1.1.2c.2.2.3.3.7.4l.4.2.4.3c.4.2.5.3.3.7v.3l.1.3c0 .2.2.4.4.5l.2.3v.7l-.4 2c0 .2 0 .3.2.4.1.2.4.3.5.3v-.2c-.1-.2-.1-.2 0-.4v-.7l.3-.4.7-.6.6-.7c.3-.3.4-.5.5-1v-.4l-.6-.3c-.2 0-.3 0-.6-.4a2 2 0 0 0-1.2-.5h-.4l-.6-.2-.2-.4c0-.2-.1-.2-.3 0-.2.1-.3.1-.4-.1 0-.4 0-.6.5-.6h.3l.2.3v.1l.1-.1v-.2l.2-.3.3-.4c0-.2.2-.3.4-.4l1-.5-.3-1L7 10v-.4h-.1c-.2.3-.2.2-.3 0-.1-.1-.6-.3-.6-.1v1.1l-.2.1-.1-.1c0-.2 0-.2-.2-.3l-.4-.1-.2-.4.2-.4.3-.1.4-.1v-.4c0-.2 0-.4-.2-.6l-.1-.1-.3.1-.3.1H3.3C3 8 3 8 2.5 8.1c-.5 0-.7 0-1.2-.2S.7 7.8.4 8ZM21 11.3l-.2.5-.4.6c-.2 0-.4.4-.3.4l.7-.5.1-.3.1-.3c.1 0 .1-.3 0-.4Zm-3.2 3.4.3.5.3.2h.4c.2.2.3.2.3.1h.2c.3 0 .4-.1.4-.3 0-.3-.1-.4-.4-.2l-.2.1v-.4s-.4.1-.5.3h-.1l-.4-.2-.3-.2v.1Zm2.5.4.1.1c.2 0 .2.1.2.2 0 0 .2.2.5.2h.4l-.1-.2-.6-.3h-.5Zm.5.8c-.1.1-.3.2-.3 0s-.2-.2-.4 0h-.2l-.3.3-.3.2c-.3 0-.3.1-.3.4v.5c0 .3.1.3.7.1.5-.1.6-.1.9.2.2.2.2.2.5.2h.3l.3-1-.2-.3-.4-.5-.1-.3-.2.2Z",clipRule:"evenodd"}))},{value:"table",label:(0,r.__)("Table","frm-charts"),icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"25",fill:"none"},(0,t.createElement)("rect",{width:"22.5",height:"17.5",x:".8",y:"4.3",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",rx:"1.3"}),(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M1 9.5h22m-22 4h22m-22 4h22m-14 4v-12m7 12v-12"}))}],value:e.type||l.type,onChange:e=>{"table"!==e&&"geo"!==e||a({format:""}),a({type:e})}})),"table"!==e.type&&"geo"!==e.type&&(0,t.createElement)(i.SelectControl,{label:(0,r.__)("Format","frm-charts"),options:[{value:"",label:(0,r.__)("Javascript","frm-charts")},{value:"image",label:(0,r.__)("Image","frm-charts")}],disabled:!FrmChartsGraph.gdSupported,value:e.format||l.format,onChange:e=>a({format:e})}),!FrmChartsGraph.gdSupported&&(0,t.createElement)("p",{className:"components-base-control__help"},(0,r.__)('Note: The "image" format requires the GD Image library for WordPress. Please contact your hosting provider to enable it.',"frm-charts"))))}function ee({value:e,onChange:a,formFields:l=[],dateOnly:n=!1}){const o=[{label:(0,r.__)("Select data source","frm-charts"),value:""},{label:(0,r.__)("Created at","frm-charts"),value:"created_at"},{label:(0,r.__)("Updated at","frm-charts"),value:"updated_at"}];return l.forEach((({id:e,name:t,type:r})=>{n&&"date"!==r||o.push({label:t,value:e})})),(0,t.createElement)(N,{value:e,onChange:a,options:o,placeholder:(0,r.__)("Select data source","frm-charts")})}function te({attributes:e,setAttributes:a}){const l=w();return(0,t.createElement)(i.Panel,null,(0,t.createElement)(i.PanelBody,{title:(0,r.__)("Horizontal axis","frm-charts")},(0,t.createElement)(i.BaseControl,{label:(0,r.__)("Data source","frm-charts")},(0,t.createElement)(ee,{value:e.x_axis||"",onChange:e=>a({x_axis:e}),formFields:e.formFields,dateOnly:e.dataOverTime})),(0,t.createElement)(i.ToggleControl,{label:(0,r.__)("Data over time graph","frm-charts"),checked:e.dataOverTime||!1,onChange:()=>a({dataOverTime:!e.dataOverTime})}),"geo"!==e.type&&(0,t.createElement)(i.SelectControl,{label:(0,r.__)("Data type","frm-charts"),options:g(),value:e.data_type||l.data_type,onChange:e=>a({data_type:e})}),(0,t.createElement)(i.TextControl,{label:(0,r.__)("X-axis title","frm-charts"),value:e.x_title||l.x_title,onChange:e=>a({x_title:e})}),"image"===e.format&&e.x_title&&(0,t.createElement)(P,{label:(0,r.__)("X-axis title margin","frm-charts"),value:e.x_title_margin||l.x_title_margin,onChange:e=>a({x_title_margin:e})}),(0,t.createElement)(i.__experimentalGrid,{columns:2},(0,t.createElement)("div",null,(0,t.createElement)(i.TextControl,{label:(0,r.__)("X-axis min value","frm-charts"),value:e.x_min||l.x_min,onChange:e=>a({x_min:e})})),(0,t.createElement)("div",null,(0,t.createElement)(i.TextControl,{label:(0,r.__)("X-axis max value","frm-charts"),value:e.x_max||l.x_max,onChange:e=>a({x_max:e})}))),(0,t.createElement)(X,{properties:v(),addedProperties:e.xAxisProps||[],onChange:e=>a({xAxisProps:e}),attributes:e})))}function re({attributes:e,setAttributes:a}){const l=w();return(0,t.createElement)(i.Panel,null,(0,t.createElement)(i.PanelBody,{title:(0,r.__)("Vertical axis","frm-charts")},(0,t.createElement)(i.TextControl,{label:(0,r.__)("Y-axis title","frm-charts"),value:e.y_title||l.y_title,onChange:e=>a({y_title:e})}),"image"===e.format&&e.y_title&&(0,t.createElement)(P,{label:(0,r.__)("Y-axis title margin","frm-charts"),value:e.y_title_margin||l.y_title_margin,onChange:e=>a({y_title_margin:e})}),(0,t.createElement)(i.__experimentalGrid,{columns:2},(0,t.createElement)("div",null,(0,t.createElement)(i.TextControl,{label:(0,r.__)("Y-axis min value","frm-charts"),value:e.y_min||l.y_min,onChange:e=>a({y_min:e})})),(0,t.createElement)("div",null,(0,t.createElement)(i.TextControl,{label:(0,r.__)("Y-axis max value","frm-charts"),value:e.y_max||l.y_max,onChange:e=>a({y_max:e})}))),(0,t.createElement)(X,{properties:b(),addedProperties:e.yAxisProps||[],onChange:e=>a({yAxisProps:e}),attributes:e})))}const ae=(0,t.createElement)(d.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(d.Path,{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM15.5303 8.46967C15.8232 8.76256 15.8232 9.23744 15.5303 9.53033L13.0607 12L15.5303 14.4697C15.8232 14.7626 15.8232 15.2374 15.5303 15.5303C15.2374 15.8232 14.7626 15.8232 14.4697 15.5303L12 13.0607L9.53033 15.5303C9.23744 15.8232 8.76256 15.8232 8.46967 15.5303C8.17678 15.2374 8.17678 14.7626 8.46967 14.4697L10.9393 12L8.46967 9.53033C8.17678 9.23744 8.17678 8.76256 8.46967 8.46967C8.76256 8.17678 9.23744 8.17678 9.53033 8.46967L12 10.9393L14.4697 8.46967C14.7626 8.17678 15.2374 8.17678 15.5303 8.46967Z"})),le=(0,t.createElement)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(d.Path,{d:"M18 11.2h-5.2V6h-1.6v5.2H6v1.6h5.2V18h1.6v-5.2H18z"})),ne=({text:e,onToggle:r})=>(0,t.createElement)("p",{style:{textAlign:"right"}},(0,t.createElement)(i.Button,{variant:"link",onClick:r},e));function oe({value:e,onChange:a}){const[l,n]=(0,m.useState)(!1),o=()=>{n(!l)},s=T("color.palette.theme");return(0,t.createElement)("div",null,(0,t.createElement)("p",null,(0,t.createElement)("strong",null,(0,r.__)("Select a color","frm-charts"))),!l&&(0,t.createElement)("div",null,(0,t.createElement)(i.ColorPalette,{colors:s,value:e,onChange:e=>a(e),disableCustomColors:!0,clearable:!1}),(0,t.createElement)(ne,{text:(0,r.__)("Custom color","frm-charts"),onToggle:o})),l&&(0,t.createElement)("div",null,(0,t.createElement)(i.ColorPicker,{color:e,onChange:e=>a(e)}),(0,t.createElement)(ne,{text:(0,r.__)("Theme color","frm-charts"),onToggle:o})))}function se({colors:e,onChange:r}){const[a,l]=(0,m.useState)({}),[n,o]=(0,m.useState)(!1),s=C().map((e=>({color:e,name:e})));return(0,t.createElement)("div",null,(0,t.createElement)("ul",{className:"frm-charts-color-buttons"},e.map(((a,n)=>(0,t.createElement)("li",{key:n},(0,t.createElement)(i.Button,{onClick:()=>((e,t)=>{l({color:e,index:t}),o(!0)})(a,n),className:"frm-charts-color-button component-color-indicator block-editor-panel-color-gradient-settings__color-indicator",style:{background:a}}),(0,t.createElement)(i.Button,{onClick:()=>(t=>{r(_(e,t))})(n),className:"frm-charts-remove-color-button",icon:ae,iconSize:16})))),(0,t.createElement)("li",null,(0,t.createElement)(i.Button,{icon:le,variant:"tertiary",size:"small",onClick:()=>{const t=s.length?s[e.length%s.length].color:"";r([...e,t])}}))),n&&(0,t.createElement)(i.Popover,{onClose:()=>(l({}),void o(!1))},(0,t.createElement)("div",{style:{minWidth:"248px",padding:"10px"}},(0,t.createElement)(oe,{value:a.color,onChange:t=>((t,a)=>{l({color:t,index:a}),r(e.map(((e,r)=>a===r?t:e)))})(t,a.index)}))))}function ce({attributes:e,setAttributes:a}){const l=w();return(0,t.createElement)(i.Panel,null,(0,t.createElement)(i.PanelBody,{title:(0,r.__)("Appearance","frm-charts")},(0,t.createElement)(i.__experimentalGrid,{columns:2,className:"components-base-control"},(0,t.createElement)("div",null,(0,t.createElement)(P,{label:(0,r.__)("Height","frm-charts"),value:e.height||l.height,onChange:e=>a({height:e})})),(0,t.createElement)("div",null,(0,t.createElement)(P,{label:(0,r.__)("Width","frm-charts"),value:e.width||l.width,onChange:e=>a({width:e})}))),"geo"!==e.type&&(0,t.createElement)(t.Fragment,null,(e=>{if(e.x_axis)return!0;if(!e.fields||1!==e.fields.length||!e.formFields||!e.formFields.length)return!0;const t=parseInt(e.fields[0]);for(let r=0;r<e.formFields.length;r++)if(t===parseInt(e.formFields[r].id)&&"nps"===e.formFields[r].type)return!1;return!0})(e)&&(0,t.createElement)(i.BaseControl,{label:(0,r.__)("Graph colors","frm-charts")},(0,t.createElement)(se,{colors:e.colors||C(),onChange:e=>a({colors:e})})),"image"!==e.format&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(i.ToggleControl,{label:(0,r.__)("Animate","frm-charts"),checked:e.animate||!1,onChange:e=>a({animate:e})}),e.animate&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(P,{label:(0,r.__)("Animation duration","frm-charts"),units:["ms"],value:e.animation_duration||l.animation_duration,onChange:e=>a({animation_duration:e.replace("ms","")})}),(0,t.createElement)(i.SelectControl,{label:(0,r.__)("Animation easing","frm-charts"),options:[{value:"linear",label:(0,r.__)("Linear","frm-charts")},{value:"in",label:(0,r.__)("In","frm-charts")},{value:"out",label:(0,r.__)("Out","frm-charts")},{value:"inAndOut",label:(0,r.__)("In-Out","frm-charts")}],value:e.animation_easing||l.animation_easing,onChange:e=>a({animation_easing:e})}))),(0,t.createElement)(X,{properties:E(),addedProperties:e.displayProps||[],onChange:e=>a({displayProps:e}),attributes:e}))))}function ie({attributes:e,setAttributes:a}){const l=(0,m.useRef)(null),n=()=>{window.getSelection().selectAllChildren(l.current)};return(0,t.createElement)(i.Panel,null,(0,t.createElement)(i.PanelBody,{title:(0,r.__)("Shortcode","frm-charts")},window.isSecureContext&&(0,t.createElement)(i.Button,{size:"small",variant:"secondary",onClick:()=>{n(),navigator.clipboard.writeText(l.current.innerText)},className:"frm-charts-shortcode-copy"},(0,r.__)("Copy","frm-charts")),(0,t.createElement)("pre",{ref:l,className:"frm-charts-shortcode-text",onClick:()=>n()},(e=>{const t=[],r=["filters","xAxisProps","yAxisProps","displayProps","legendProps"],a=["formFields","chart_area_width","chart_area_height","chart_area_top","chart_area_left","className"],l=["animate","animation_duration","animation_easing"],n=(e,r)=>{""!==r&&-1===a.indexOf(e)&&("dataOverTime"!==e?"curve_type"!==e?("object"==typeof r?r=Object.values(r).join(","):!0===r?r=1:!1===r&&(r=0),"string"==typeof r&&(r=r.replace(/"/g,"&quot;")),-1<(window.FrmChartsGraph.fontSizeSettings||[]).indexOf(e)&&(r=r.replace("px","")),t.push(`${e}="${r}"`)):r&&t.push('curve_type="function"'):r&&t.push('include_zero="1"'))};for(let t in e)"form"===t&&e.fields&&e.fields.length||!e.animate&&l.indexOf(t)>-1||(-1!==r.indexOf(t)?"object"==typeof e[t]&&e[t].length&&e[t].forEach((e=>{n(e.name.replace("{field}",e.field||""),e.value)})):n(t,e[t]));const o=(()=>{if(!e.displayProps)return"";const t=[];return e.displayProps.forEach((e=>{e.value&&e.name.match(/^chart_area_/)&&t.push(`${e.name.replace(/^chart_area_/,"")}:${e.value.replace("px","")}`)})),t.length?t.join(","):""})();return o&&n("chart_area",o),`[frm-graph ${t.join(" ")}]`})({...e}))))}const me=JSON.parse('{"UU":"frm-charts/graph"}');(0,a.registerBlockType)(me.UU,{title:FrmChartsGraph.menuName+" "+(0,r.__)("Chart","frm-charts"),edit:function({attributes:e,setAttributes:a,clientId:l,isSelected:s}){const[i,h]=(0,m.useState)(!1);"image"===e.format&&FrmChartsGraph.gdSupported||(()=>{const e=x().frmJsUrl||"";if(!e)return"";let t="formidablepro-js";e.indexOf("frm.min.js")&&(t="formidable-js");let r=document.getElementById(t);if(r||(r=document.createElement("script"),r.setAttribute("src",e),r.setAttribute("id",t),window.frm_js=window.frm_js||{},document.getElementById("frm-charts-graph-editor-script-js-extra").after(r)),!document.getElementById("google_jsapi-js")){const e=document.createElement("script");e.setAttribute("src","https://www.gstatic.com/charts/loader.js?ver=6.6"),e.setAttribute("id","google_jsapi-js"),r.after(e)}})(),(0,m.useEffect)((()=>{e.form&&(h(!0),c()({path:"frm-charts/v1/graph?graph_id="+l,method:"POST",data:{attributes:e,graph_id:l}}).then((t=>{if("object"!=typeof t.graphData)return void h(!1);const r=document.getElementById(`frm-charts-graph-${l}`);r?(r.innerHTML=t.graphContent,"image"===e.format&&FrmChartsGraph.gdSupported||(window.__FRMTABLES=t.graphData,"undefined"==typeof frmProForm?setTimeout((()=>{frmProForm.loadGoogle()}),30):frmProForm.loadGoogle()),h(!1)):h(!1)})))}),[e]),(0,m.useEffect)((()=>{s&&"edit-post/block"!==(0,n.select)("core/interface").getActiveComplementaryArea("core")&&(0,n.dispatch)("core/interface").enableComplementaryArea("core","edit-post/block")}),[s]);const d=(0,o.useBlockProps)({className:i?"frm-charts-is-loading":""});return(0,t.createElement)("div",{...d},(0,t.createElement)(o.InspectorControls,{key:"settings"},(0,t.createElement)(R,{attributes:e,setAttributes:a}),!!e.form&&(0,t.createElement)(t.Fragment,null,"geo"!==e.type&&(0,t.createElement)(z,{attributes:e,setAttributes:a}),(0,t.createElement)(K,{attributes:e,setAttributes:a}),(u=e.type,["column","hbar","line","area","scatter","stepped"].indexOf(u)>-1&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(te,{attributes:e,setAttributes:a}),(0,t.createElement)(re,{attributes:e,setAttributes:a}))),(0,t.createElement)(ce,{attributes:e,setAttributes:a}),"table"!==e.type&&(0,t.createElement)(J,{attributes:e,setAttributes:a})),(0,t.createElement)(ie,{attributes:e,setAttributes:a})),!e.form&&(0,t.createElement)("div",{style:{textAlign:"center"}},(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 521 223",width:"521",height:"223"},(0,t.createElement)("path",{fill:"#F0F0F0",d:"M0 70h98v153H0zM141 0h98v223h-98zm141 77h98v146h-98zm141 99h98v47h-98z"}))),i&&(0,t.createElement)("div",{className:"frm-charts-loading-text"},(0,r.__)("Loading graph...","frm-charts")),(0,t.createElement)("div",{id:`frm-charts-graph-${l}`}));var u},icon:(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 25 23"},(0,t.createElement)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2.5",d:"M23 2v19m-7-7.5V21M9 10.8V21m-7-2.9V21"})),save:function(){return null},transforms:{from:[{type:"block",blocks:["core/shortcode"],isMatch:function({text:e}){return/^\[frm-graph /.test(e)},transform:function({text:e}){const t=e.replace(/^\[frm-graph /,"").replace(/]$/,""),r=(0,l.attrs)(t);return(0,a.createBlock)(me.UU,(e=>{const t={filters:[],xAxisProps:[],yAxisProps:[],displayProps:[],legendProps:[]},r=v(),a=b(),l=E(),n=y(),o=k(),s=(e,t,r="name")=>{for(let a=0;a<t.length;a++)if("object"==typeof t[a]&&e===t[a][r])return!0;return!1};return Object.keys(e).forEach((c=>{let i=e[c].replaceAll("&quot;",'"');if("include_zero"===c)return void(i&&"0"!==i&&(t.dataOverTime=!0));if("fields"===c||"colors"===c)return void(t[c]=i.split(","));if("curve_type"===c)return void("function"===i&&t.displayProps.push({name:c,value:!0}));if("chart_area"===c)return void i.split(",").forEach((e=>{const[r,a]=e.split(":");t.displayProps.push({name:"chart_area_"+r,value:a})}));"0"===i&&(i=0);const m=/^\d+/,h=c.match(m);if(h)return void t.filters.push({name:c.replace(m,"{field}"),field:h[0],value:i});let d=!1;s(c,r)?d="xAxisProps":s(c,a)?d="yAxisProps":s(c,l)?d="displayProps":s(c,n)?d="legendProps":s(c,o,"value")&&(console.log(c),d="filters"),d?t[d].push({name:c,value:i}):t[c]=i})),t})(r.named))}}]}})})();